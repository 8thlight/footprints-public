####
# Env vars are, in order:
# DEPLOY_KEY
# CAPISTRANO_SERVER
# CAPISTRANO_DEPLOY_USER
# CAPISTRANO_DEPLOY_PATH_TO_SSH_KEY
# CAPISTRANO_STAGING_DEPLOY_TO
# CAPISTRANO_PRODUCTION_DEPLOY_TO

language: ruby
cache:
  bundler: true
  directories:
    - /home/travis/.rvm
rvm:
- 2.1.5
before_script:
- mysql -e 'create database footprints_test;'
- cp config/ci.database.yml config/database.yml
- cp config/mailer.yml.example config/mailer.yml
script: bundle exec rake
after_success:
  - "[[ $TRAVIS_BRANCH = 'master' || $TRAVIS_BRANCH = 'develop' ]] && [[ $TRAVIS_PULL_REQUEST = 'false' ]] && openssl aes-256-cbc -k $DEPLOY_KEY -in config/deploy_id_rsa_enc_travis -out config/deploy_id_rsa -d -a"
  - "[[ $TRAVIS_BRANCH = 'master' && $TRAVIS_PULL_REQUEST = 'false' ]] && bundle exec cap production deploy"
  - "[[ $TRAVIS_BRANCH = 'develop' && $TRAVIS_PULL_REQUEST = 'false' ]] && bundle exec cap staging deploy"
env:
  global:
  - secure:  Q0nhdXwDBW3WXI0MjnjYBflOKjxDsSSgijD7G67rZSNgcT68g8WGRa1nMx1TBjVTwuAy3heqVZlUlu9eri6ypnyi18YVY0cB6R6gY4BjOOcv15QkFPzY1Xtv1BM0FkVtCU4/Q7APWdgmXCQ75dYWP6uSs5COadxRoh3cLunsjPiYD7T3HV+zn7Fr3fZn940BcS7Hre0G1Hf64No6SV5duB8bJ9f4fTHYUCmikIw84rM9Prz7AUZJA4NTCKas2V5MSR6yO3IJLfaPv65hE1VLWlwdrPoyP+odbTrOs4FC7XSiuw1Zf2jgUnk4LEeRQKwO6mjG0FSWm9nn3cTqmOgkBN9748Nm2tTJPXAL3tszC6BQARdDzmxiZ/FHjspTYe4W4o3CJqQI1rW+zwjBn6mGwfnrQp4Kh0TSxGGptbqb5hNrcGacy13FQWx767aYGpf+MQzgujy8UIBKl0+bYegx2aMMTyiGlif8vYBzk9tuUYhKdViyJ0fTiOR/v9Ic8QmoelySStwKwP/R8s4hMVQBtSL+z9XHWnB6p16sZ/EMOTWVBpxMOxlahovn+1iDUjG1e5Y07fLb/AeuvHqqUTuaoOFFq07i5g7RJDtDvvn6BUVC5nNy9aY4bOdLrQKbsUU9rczi5PUhu7Q+qBa5EZ7xUo6/GMYj19Fkn0F7l7Dym+c=
  - secure: WwulkIAfi0An/2Os/PSeUbgFKy5aTNRfC7WfbUaYH+Bt0iCP5MDIxKuOSVkz2ToMls0ZiFmcw2TdHMMjTV9P5dAsPMBCZ4UxIVqk15eQcHrpzH9c5pFh/UK1J6wwQC//mNpjSnxb+0UhdllPz+yRq4P192ajB0vsyHXCsjArGwHj3ArlN4laOrDjfVsydyPVsTXo/PatDrhapWmm2poBlqDAiajgwSMEIAkvMiYJjBmGqZohu3tiiqkTdJ/3ZOhDo+xHi5PfCcllocpEGG/TyRbdzxEJ2UnAHWmuadAIncoH36ACTRPhI/eNboxKcWPjF3P0gwbmdO1PSlv4hksj4HePIbUIdIEsA7FxgLMnlSEXMk/YTV9hKN0EY8ftrZyzjh2tTMfTmiDOVAeckMRcp2kPYfTVsGybWE+fuYIH3AIY3gWGI/87a7arBMY+Cfal1Vxzi9Q6UuV7oXGbVNIA74YXuu/rFQgfA+942z6ua5CNGAhhqCef65Kg4HlucyLyNKoq/62nVYZW9HDJczsPirHbuuSDut01XieHoqCghscRpMICc3YTTHAas7XPB9JLbBmgjIqonFHgiziGOCMq6IgpdXM7H7gNj72V8z0Dkh670ucNOQ5H41CoKqB5+lVD5laTtzi+U5VKv4sF39JHCmIY+yW3uAdjihsXLVGMgos=
  - secure: lZGr/+RGsMncmPDB4IjsKg8QctSSh2y7OjJ/Xs0DHsOmfX0BqPLedT3a//Zh+6B+uJ2PDhPRQ4qdcb58v9fX0rzzFJonqyftQuIj6vC2eHimG0MaX3OSxKZHZQ7Ylo7UBWsAAeJWQrTanihJ+RXSzIM/xi9tMjVDMQAZLbRKTL9aaCGpHzUrNKTZJndBDEiIuNgDDqeHnGkVPi9mbHF/giThK6zESniEm+FribVUdzkEuNAysZM2L7faIDNbHCv17vpnCKEwI+Bk74bKJv6PfVL/1cgpW1+sSWdtbUzxqKhlfMo/KDV+5XLM2Lrqg1e+EAauT7dcX8RiIpTouAiuBjBo8NvdV9QtBMPcO8qwwmanzoICdxImAI2rMQIMJxiyRt0U5Ucy8DLpvnwLujqlVfWXK1O0WxZDdBX30V7UKmrS5PdrScsTc13tP4ryfi80CQIqJwJF93vSYVWE4zyX2jHYN/7UCd8YZLaNcpi+tTJfoST5M4g8Jr67TUhS4sBkVNpbWgmLGbR+7Ren4K7AE//nXYYuzY57yx6cPKufckRJbKzankTH/ISjmvxHpuiYJV3SoGVHN9rVimJTa+pqXTu68AlmngKnSsrL/J6fXwGhJt3wRwKSOvnXrC70pXpOf316tBwtdSsFcBAHG8snVJuzC6wqySQWkV9ifH+55ME=
  - secure: aYx+9kQ12oC3mgJD0+UgKVk3hNAOk4U4UZ4yjcER0vDA5foyucgZFzBHTaS/JtQplUn/allEWRo3+6OUrhZzDifMCzZtLEKs2rWhBT/Qbn189E17qyz5OnuWbOgu3FHpV86yMLbLu/6zAZIDg+4uQuNnP4QD2ocQLxn/3gpC4YogcruR9EDviD7tAkz88Wb1y7Ha7rFot/qL3QL3X6nl0CmuF6hcH3AtO+lUStAvV/bQ0derEjadINtlo6+M3VL5bjzFSCQsfwbDeSNPlbK4mdTFVXd8X90yfEYEiYonNar1QKNTt5ZaJR0bl3oPngYclhBh0N9DxrR3njf0n4tnmf1kz9Qtqwo1uzX5n6/tl/JMvfFkhVQo416zf7hFudnHO2xc5MCidgnC+uJESECC+KvaUXTJRSUWYQnjKlIiEWTfxw0KBVR21kBU0Uh2AmQAo6ibOynG9RMVPzjosH9aRTNPlWW0cyL9ncBcc6T68C30AiGvJORsxQ/bFy69pLbAiNsDuNkACP+VxW6OtTk6SE4nnBETaVeWTmCKD3lEL1tGkwl9+2iquGutc9PtOX4YPPa+so+yZb+E23s2NTnX39dNAUZh0h8Soe4PqvArIEjwHJX4YQ/lG/g0bX9NGBrbtI627ICdAqJ9mWvupA4y+2R1o6XKLjnoJPErv/7Uh7o=
  - secure: D+1KxdcfqzHnpZ23KcJZoDPE8nG5Mo1xR8tvGbQuSrs54qh+sa/zkgSAMEvYvVnjnChPdJ6IFdTObewJYUSDaOd6pywfY8kvxZ9L/103vFdOo+IVlcN6AcMl3HXPgI7lq2CKxXmHqxqvrA0CD+yHtKg7kRiGm32UZt687oo+0KGVEN3NhxCTywm32RH8CEkR8aLDJs7yQ6SF+4TSK2Q/Uq/rTc2gvRUVjnu+RClf4aedj/sKLGnZKxhl+evJVaz1Zu6T2m9Nj8C+VKvG2nzxWfhmhvC1dfAmEWapjWAlwBi1szs/uCzQUlMglKocR/Fcy/WC5u1tZBbu4mtuLcxXT4G2tTSBTrm7zYYiRBW2byKG9Aud/wl7mkDd4QASsOjTkPyZ7jVjxsAOzEBShJhVgZJZHrVqtTTTRs2ukahb+z3SMBL9aHLzNdd8JtZpvg4M1inpbyiAXRV0ONCNfBkDWAVlNucMWX1xnGaldOqyovogPEbaClPIaODtwjDUuX+Cm9Pt2H8CHjsSyhFeI0J4Kv7ZiR3SUWCy5yzLr1rHr43TsUBW/w538YR1TR9dkIvkHvbWEuzb2PTEgj1wDMGzxwsF6ELep4KU0ZSLSDv090P7qVFMRNacFUGJc8B0ZMpLO72w4NNYdUVYHOEeoS8c1hEeMk8gCQx1H/IpxG9TPiM=
  - secure: JKom4FzNnklGJPwaqtXX5KMaYeUwY7iLfOCHJeVSCE7R7k8S3YO5FbOoFlnl94PUTbNmdBAHGFQLEj7gZMOpCv+omD/6UFeNsD1zBw8bvndIOfS+PY4mFvPSwQVgndkm5i0E/Mz8CVXUx3lL5NO9L/XIQpso77Qh8L8dOnJJdl3qA4AgMdXvBfFEv5Dc4jbgv/w5ns1RmYE6KEWFqNiOuX8TjrVs57969F0gaAPEoCEPZVkY2YvuFQWKdHJu0mHm9BNPfhFIGGrG9240gKSpI4Q2VF+gELo8vNSOf/mux4wg0cc5i1DabcNT/oLwYV5dQ2c4aq+xxk5VzH5r6Zh+eieG6h/EW5/bhhZ0JRPxX/aTSEQmcLxAj3shR8emg449tcOVgc9wkKoH88uzDxtVb9bdS7Oxpx0jMlYZcQGc69SUgswOuHFhJi1/lV7jGC6Dnt610o8IJWlbLkIzhK7KWB6pA8sWAZ2/DFGGNPAgw39dCNlY+ehLzUFX19Vw8mJsNZXA3Lh1eksavFpfR/HCRNsdERZx20GqUkAcyxfFljcwFC5sGycsZjEEMHlUxxm8zOjRnSADVjLUkpL+yd/Tyr2WdPYmfs73qLhbSshCGFYCGfVTdw5/izCp47oH8KxCe+3K0hBo0t1/wO/+kMCIGQKflR5NWC9qQ1ourX1LyuU=
