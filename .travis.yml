####
# Env vars are, in order:
# DEPLOY_KEY
# CAPISTRANO_SERVER
# CAPISTRANO_DEPLOY_USER
# CAPISTRANO_DEPLOY_PATH_TO_SSH_KEY
# CAPISTRANO_STAGING_DEPLOY_TO
# CAPISTRANO_PRODUCTION_DEPLOY_TO

language: ruby
cache:
  bundler: true
  directories:
    - /home/travis/.rvm
rvm:
- 2.1.5
before_script:
- mysql -e 'create database footprints_test;'
- cp config/ci.database.yml config/database.yml
- cp config/mailer.yml.example config/mailer.yml
script: bundle exec rake
after_success:
  - "[[ $TRAVIS_BRANCH = 'master' || $TRAVIS_BRANCH = 'develop' ]] && openssl aes-256-cbc -k $DEPLOY_KEY -in config/deploy_id_rsa_enc_travis -out config/deploy_id_rsa -d -a"
deploy:
  - provider: script
    script: bash bundle exec cap staging deploy
    on:
      branch: develop
  - provider: script
    script: bash bundle exec cap production deploy
    on:
      branch: master
env:
  global:
  - secure:  Q0nhdXwDBW3WXI0MjnjYBflOKjxDsSSgijD7G67rZSNgcT68g8WGRa1nMx1TBjVTwuAy3heqVZlUlu9eri6ypnyi18YVY0cB6R6gY4BjOOcv15QkFPzY1Xtv1BM0FkVtCU4/Q7APWdgmXCQ75dYWP6uSs5COadxRoh3cLunsjPiYD7T3HV+zn7Fr3fZn940BcS7Hre0G1Hf64No6SV5duB8bJ9f4fTHYUCmikIw84rM9Prz7AUZJA4NTCKas2V5MSR6yO3IJLfaPv65hE1VLWlwdrPoyP+odbTrOs4FC7XSiuw1Zf2jgUnk4LEeRQKwO6mjG0FSWm9nn3cTqmOgkBN9748Nm2tTJPXAL3tszC6BQARdDzmxiZ/FHjspTYe4W4o3CJqQI1rW+zwjBn6mGwfnrQp4Kh0TSxGGptbqb5hNrcGacy13FQWx767aYGpf+MQzgujy8UIBKl0+bYegx2aMMTyiGlif8vYBzk9tuUYhKdViyJ0fTiOR/v9Ic8QmoelySStwKwP/R8s4hMVQBtSL+z9XHWnB6p16sZ/EMOTWVBpxMOxlahovn+1iDUjG1e5Y07fLb/AeuvHqqUTuaoOFFq07i5g7RJDtDvvn6BUVC5nNy9aY4bOdLrQKbsUU9rczi5PUhu7Q+qBa5EZ7xUo6/GMYj19Fkn0F7l7Dym+c=
  - secure: WwulkIAfi0An/2Os/PSeUbgFKy5aTNRfC7WfbUaYH+Bt0iCP5MDIxKuOSVkz2ToMls0ZiFmcw2TdHMMjTV9P5dAsPMBCZ4UxIVqk15eQcHrpzH9c5pFh/UK1J6wwQC//mNpjSnxb+0UhdllPz+yRq4P192ajB0vsyHXCsjArGwHj3ArlN4laOrDjfVsydyPVsTXo/PatDrhapWmm2poBlqDAiajgwSMEIAkvMiYJjBmGqZohu3tiiqkTdJ/3ZOhDo+xHi5PfCcllocpEGG/TyRbdzxEJ2UnAHWmuadAIncoH36ACTRPhI/eNboxKcWPjF3P0gwbmdO1PSlv4hksj4HePIbUIdIEsA7FxgLMnlSEXMk/YTV9hKN0EY8ftrZyzjh2tTMfTmiDOVAeckMRcp2kPYfTVsGybWE+fuYIH3AIY3gWGI/87a7arBMY+Cfal1Vxzi9Q6UuV7oXGbVNIA74YXuu/rFQgfA+942z6ua5CNGAhhqCef65Kg4HlucyLyNKoq/62nVYZW9HDJczsPirHbuuSDut01XieHoqCghscRpMICc3YTTHAas7XPB9JLbBmgjIqonFHgiziGOCMq6IgpdXM7H7gNj72V8z0Dkh670ucNOQ5H41CoKqB5+lVD5laTtzi+U5VKv4sF39JHCmIY+yW3uAdjihsXLVGMgos=
  - secure: lZGr/+RGsMncmPDB4IjsKg8QctSSh2y7OjJ/Xs0DHsOmfX0BqPLedT3a//Zh+6B+uJ2PDhPRQ4qdcb58v9fX0rzzFJonqyftQuIj6vC2eHimG0MaX3OSxKZHZQ7Ylo7UBWsAAeJWQrTanihJ+RXSzIM/xi9tMjVDMQAZLbRKTL9aaCGpHzUrNKTZJndBDEiIuNgDDqeHnGkVPi9mbHF/giThK6zESniEm+FribVUdzkEuNAysZM2L7faIDNbHCv17vpnCKEwI+Bk74bKJv6PfVL/1cgpW1+sSWdtbUzxqKhlfMo/KDV+5XLM2Lrqg1e+EAauT7dcX8RiIpTouAiuBjBo8NvdV9QtBMPcO8qwwmanzoICdxImAI2rMQIMJxiyRt0U5Ucy8DLpvnwLujqlVfWXK1O0WxZDdBX30V7UKmrS5PdrScsTc13tP4ryfi80CQIqJwJF93vSYVWE4zyX2jHYN/7UCd8YZLaNcpi+tTJfoST5M4g8Jr67TUhS4sBkVNpbWgmLGbR+7Ren4K7AE//nXYYuzY57yx6cPKufckRJbKzankTH/ISjmvxHpuiYJV3SoGVHN9rVimJTa+pqXTu68AlmngKnSsrL/J6fXwGhJt3wRwKSOvnXrC70pXpOf316tBwtdSsFcBAHG8snVJuzC6wqySQWkV9ifH+55ME=
  - secure: aYx+9kQ12oC3mgJD0+UgKVk3hNAOk4U4UZ4yjcER0vDA5foyucgZFzBHTaS/JtQplUn/allEWRo3+6OUrhZzDifMCzZtLEKs2rWhBT/Qbn189E17qyz5OnuWbOgu3FHpV86yMLbLu/6zAZIDg+4uQuNnP4QD2ocQLxn/3gpC4YogcruR9EDviD7tAkz88Wb1y7Ha7rFot/qL3QL3X6nl0CmuF6hcH3AtO+lUStAvV/bQ0derEjadINtlo6+M3VL5bjzFSCQsfwbDeSNPlbK4mdTFVXd8X90yfEYEiYonNar1QKNTt5ZaJR0bl3oPngYclhBh0N9DxrR3njf0n4tnmf1kz9Qtqwo1uzX5n6/tl/JMvfFkhVQo416zf7hFudnHO2xc5MCidgnC+uJESECC+KvaUXTJRSUWYQnjKlIiEWTfxw0KBVR21kBU0Uh2AmQAo6ibOynG9RMVPzjosH9aRTNPlWW0cyL9ncBcc6T68C30AiGvJORsxQ/bFy69pLbAiNsDuNkACP+VxW6OtTk6SE4nnBETaVeWTmCKD3lEL1tGkwl9+2iquGutc9PtOX4YPPa+so+yZb+E23s2NTnX39dNAUZh0h8Soe4PqvArIEjwHJX4YQ/lG/g0bX9NGBrbtI627ICdAqJ9mWvupA4y+2R1o6XKLjnoJPErv/7Uh7o=
  - secure: R4YNSvwvU9D+Zjtvdf4YYe+kSd89zPeM5zc2ulsqrQrBtyhB+O8VnLVeZ4W5EcRl8b4s6A8XzbXS6tMOpjmzNMkZv0CElyBNmpjiRKvOesgtiV9WiFD+7K/HzdWAX4m+yH6igYoRT6gvXZNlYIm3K9XOxiLDd2dmO4daWuR3ZD+YprWbS/YeJ5PrI4FQLWvnQ2VtmaHtpTgLNw5itilerxjhYyS/cTghnR29nubvyEQOFmcZkwcBLwbMCBA2zSUssOpN7mnJGbfutYEIXuedmrNjAq3jjZrXLP7gcMPMGEX0r9Fz7yyulHLC4bJKW5teg4cgz7pfpwaPqTY02eoFfqqrz2wcfjX1feGQBrLujfPV87tRtTflEmuYtyFFD1u9Uh5dHTDpknxx4HRsQzJzPLSp19ridhNqm7Rb0l0Fh+fVhDlX31xDAQEiKA64+bDicBdiep+rd7j0nkOvSTcY0bLqAjZtlQ94mxsc+si8nfMhVmUIEz8P6Axu21k4rgKY+eKgjb9rZpGe2yJG9AsLwkvCIBSJj+18PUrc2U3Dvg0815G7+IFxlm/H2udmob4J6rnR5WTn/hbYsNL8MID/7DoXk3wrU7V5Q4FilY2dQASusHMfMace5KB2XWTyGsOIGsemI8mPSY7gNwIFyQaTIEqfgWP5bVBeAJPbhmVSUpo=
  - secure: I9fEzncSDVvoeIYQLjdoASPTjEXduwNNS2IZ4ZeX3Rho0wOYLI1ts7ie+x+NtGNnRAPmtaUgBDv+cm8ucuWimQ9ZoMpuwdXk5dDhpgtD45JPh7HiFZspOqMekCeEK3LgRQK/OU9VyOMbD2fjAoAA7waTgb12tVLjs1FeIaEpFYI5n7Kr6sOXbm0Avp0nxqo21ntMOjoyUiV7QilVTJ6RBULd9IhppB2h3Teh7PnqFshmhqc0Gt7it4TH1ojW8B5SmpUW8g/3tSPBHf7XDAMJzd4ooTwfAwOg0mE2lWu/WsXaf+Dn/OMq+gPMg64BacmuFilOpmOkHWoIz3Yt1hd4RCB4bidM3dDMO0UfqKGo6sdRWIq/E86cuQKlgEzbJVG5rAwa2xaekBi5TOqvwSNjbjfjAi99PhGPLWCFyA8EcXH2bgAlWTBTt+jZ6LKswH3vyvKMO9CskUQkPxSCjoumUglXQxQ5YJHRJ/W4tJdhTH40toglLipkrSsemxpOYBy5WceT5umrkXpUSBvFKSO9ljS8b2TO9ZSYtaEeuh6xPNlGj6Exy79saX7SMuFT885GhcwUxhIL36kzRiWKrIoKL2BiBZoaz1+0W59eoR/7Gm3RPC7mCVoAPnIknTV7XQAI1JE6sJHd0tcVMzyAV+wOjwTFd4PeG9qT/ZYLH+DTps8=
